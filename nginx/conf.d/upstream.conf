# Upstream configuration for Nginx load balancing
# Uses Docker Compose DNS round-robin for load balancing across scaled instances

# Upstream for auth service (Round-robin load balancing)
upstream auth_backend {
    # Docker Compose DNS automatically resolves 'auth' to all scaled instances
    # and distributes requests in round-robin fashion
    server auth:3001 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for payments service (Round-robin load balancing)
upstream payments_backend {
    # Docker Compose DNS automatically resolves 'payments' to all scaled instances
    # and distributes requests in round-robin fashion
    server payments:3002 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

